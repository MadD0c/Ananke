[gcode_macro BED_MESH_PRINT]
gcode:
      {% set defaultcfg = printer['gcode_macro _defaultcfg'] %} ; get defaultcfg variables
      {% set notifycfg = printer["gcode_macro _notifycfg"] %} ; get notifycfg variables
      {% if defaultcfg.bed_mesh == True %}
        {% if config.bed_mesh is defined %}
            {% if defaultcfg.load_mesh == True %}
                M{notifycfg.output} Mesh print area ; status feedback
                BED_MESH_PROFILE LOAD={defaultcfg.mesh_profile} ; load mesh profile
            {% else %}
	    	{% if defaultcfg.kamp == True %}
                  M{notifycfg.output} Mesh print area ; status feedback
                  BED_MESH_CALIBRATE ; generate new mesh
		{% else %}
                  M{notifycfg.output} Mesh print area ; status feedback
                  _BED_MESH_CALIBRATE ; generate new mesh
		{% endif %}
            {% endif %}
        {% else %}
            M{notifycfg.error_output} Bed_mesh not configured!
        {% endif %}
    {% endif %}
